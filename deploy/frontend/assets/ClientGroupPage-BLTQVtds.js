import{r as s,I as ee,f as te,a6 as r,a7 as J,P as e,V as P,W as h,a8 as S,O as N,S as Z,a9 as ae,Q as B,aa as W,a0 as F,a4 as de,ad as ue}from"./index-DVAH8G0d.js";import{c as Q,R as he}from"./clientService-Cmh9Rzea.js";import{M as G}from"./index-D5-92eMw.js";import{T as q}from"./index-fw1Ls6Om.js";import{S as L,F as U}from"./Table-BH_IQYSB.js";import{S as Y}from"./index-C-m9zxKZ.js";import{R as X}from"./EditOutlined-BO1KRQYy.js";import{c as T}from"./clientSlaService-DC81kYw3.js";import{l as me}from"./laboratoryService-B77Lyyfa.js";import{M as K}from"./index-ksZeLwj1.js";import{P as se}from"./index-BDasguwL.js";import{R as le}from"./DeleteOutlined-DADLfnzs.js";import"./CheckOutlined-CP9fMx1j.js";var pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M644.7 669.2a7.92 7.92 0 00-6.5-3.3H594c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.8-5.3 0-12.7-6.5-12.7h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-22.9-31.9zM688 306v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm184 458H208V148h560v296c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h312c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm402.6-320.8l-192-66.7c-.9-.3-1.7-.4-2.6-.4s-1.8.1-2.6.4l-192 66.7a7.96 7.96 0 00-5.4 7.5v251.1c0 2.5 1.1 4.8 3.1 6.3l192 150.2c1.4 1.1 3.2 1.7 4.9 1.7s3.5-.6 4.9-1.7l192-150.2c1.9-1.5 3.1-3.8 3.1-6.3V538.7c0-3.4-2.2-6.4-5.4-7.5zM826 763.7L688 871.6 550 763.7V577l138-48 138 48v186.7z"}}]},name:"file-protect",theme:"outlined"},xe=function(o,p){return s.createElement(ee,te({},o,{ref:p,icon:pe}))},ge=s.forwardRef(xe),ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M483.2 790.3L861.4 412c1.7-1.7 2.5-4 2.3-6.3l-25.5-301.4c-.7-7.8-6.8-13.9-14.6-14.6L522.2 64.3c-2.3-.2-4.7.6-6.3 2.3L137.7 444.8a8.03 8.03 0 000 11.3l334.2 334.2c3.1 3.2 8.2 3.2 11.3 0zm62.6-651.7l224.6 19 19 224.6L477.5 694 233.9 450.5l311.9-311.9zm60.16 186.23a48 48 0 1067.88-67.89 48 48 0 10-67.88 67.89zM889.7 539.8l-39.6-39.5a8.03 8.03 0 00-11.3 0l-362 361.3-237.6-237a8.03 8.03 0 00-11.3 0l-39.6 39.5a8.03 8.03 0 000 11.3l243.2 242.8 39.6 39.5c3.1 3.1 8.2 3.1 11.3 0l407.3-406.6c3.1-3.1 3.1-8.2 0-11.3z"}}]},name:"tags",theme:"outlined"},fe=function(o,p){return s.createElement(ee,te({},o,{ref:p,icon:ye}))},je=s.forwardRef(fe);const _e=[{label:"最高 (1)",value:1},{label:"高 (2)",value:2},{label:"中 (3)",value:3},{label:"低 (4)",value:4},{label:"最低 (5)",value:5}],ve=[{label:"VIP客户",value:"vip"},{label:"内部测试",value:"internal"},{label:"外部客户",value:"external"},{label:"常规测试",value:"routine"}];function be({visible:_,client:o,onSuccess:p,onCancel:z}){const[j]=r.useForm(),[v,w]=s.useState(!1),{message:b}=J.useApp();s.useEffect(()=>{_&&(o?j.setFieldsValue(o):(j.resetFields(),j.setFieldsValue({default_sla_days:7,priority_level:3,source_category:"external",is_active:!0})))},[_,o,j]);const d=async()=>{try{const n=await j.validateFields();if(w(!0),o){const x={name:n.name,contact_name:n.contact_name||void 0,contact_email:n.contact_email||void 0,contact_phone:n.contact_phone||void 0,address:n.address||void 0,default_sla_days:n.default_sla_days,priority_level:n.priority_level,source_category:n.source_category,is_active:n.is_active};await Q.updateClient(o.id,x),b.success("客户更新成功")}else{const x={name:n.name,code:n.code,contact_name:n.contact_name||void 0,contact_email:n.contact_email||void 0,contact_phone:n.contact_phone||void 0,address:n.address||void 0,default_sla_days:n.default_sla_days,priority_level:n.priority_level,source_category:n.source_category};await Q.createClient(x),b.success("客户创建成功")}p()}catch{b.error(o?"更新失败":"创建失败")}finally{w(!1)}};return e.jsx(G,{title:o?"编辑客户":"新增客户",open:_,onOk:d,onCancel:z,confirmLoading:v,width:700,okText:"确定",cancelText:"取消",destroyOnHidden:!0,children:e.jsxs(r,{form:j,layout:"vertical",children:[e.jsx("div",{style:{borderBottom:"1px solid #e5e5e5",paddingBottom:8,marginBottom:16},children:e.jsx("span",{style:{fontSize:14,color:"#999"},children:"基本信息"})}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"name",label:"客户名称",rules:[{required:!0,message:"请输入客户名称"}],children:e.jsx(S,{placeholder:"请输入客户名称"})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"code",label:"客户代码",rules:[{required:!0,message:"请输入客户代码"}],children:e.jsx(S,{placeholder:"请输入客户代码",disabled:!!o})})})]}),e.jsx("div",{style:{borderBottom:"1px solid #e5e5e5",paddingBottom:8,marginBottom:16,marginTop:24},children:e.jsx("span",{style:{fontSize:14,color:"#999"},children:"联系信息"})}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"contact_name",label:"联系人",children:e.jsx(S,{placeholder:"请输入联系人姓名"})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"contact_email",label:"联系邮箱",rules:[{pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"请输入有效的邮箱地址"}],children:e.jsx(S,{placeholder:"请输入联系邮箱"})})})]}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"contact_phone",label:"联系电话",children:e.jsx(S,{placeholder:"请输入联系电话"})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"address",label:"地址",children:e.jsx(S,{placeholder:"请输入地址"})})})]}),e.jsx("div",{style:{borderBottom:"1px solid #e5e5e5",paddingBottom:8,marginBottom:16,marginTop:24},children:e.jsx("span",{style:{fontSize:14,color:"#999"},children:"SLA配置"})}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:8,children:e.jsx(r.Item,{name:"default_sla_days",label:"默认SLA天数",rules:[{required:!0,message:"请输入SLA天数"}],children:e.jsx(q,{min:1,max:90,style:{width:"100%"},placeholder:"默认SLA天数"})})}),e.jsx(h,{span:8,children:e.jsx(r.Item,{name:"priority_level",label:"优先级",rules:[{required:!0,message:"请选择优先级"}],children:e.jsx(L,{placeholder:"请选择优先级",options:_e})})}),e.jsx(h,{span:8,children:e.jsx(r.Item,{name:"source_category",label:"来源类别",rules:[{required:!0,message:"请选择来源类别"}],children:e.jsx(L,{placeholder:"请选择来源类别",options:ve})})})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{borderBottom:"1px solid #e5e5e5",paddingBottom:8,marginBottom:16,marginTop:24},children:e.jsx("span",{style:{fontSize:14,color:"#999"},children:"状态"})}),e.jsx(r.Item,{name:"is_active",label:"状态",valuePropName:"checked",children:e.jsx(Y,{checkedChildren:"启用",unCheckedChildren:"停用"})})]})]})})}const Se={1:{text:"最高",color:"red"},2:{text:"高",color:"orange"},3:{text:"中",color:"blue"},4:{text:"低",color:"green"},5:{text:"最低",color:"default"}},we={vip:"VIP客户",internal:"内部测试",external:"外部客户",routine:"常规测试"};function Ce(){const[_,o]=s.useState([]),[p,z]=s.useState(!1),[j,v]=s.useState(!1),[w,b]=s.useState(null),[d,n]=s.useState({current:1,pageSize:10,total:0}),[x,R]=s.useState(""),[u,$]=s.useState(""),[m,E]=s.useState(void 0),{message:g}=J.useApp(),c=s.useRef(null),y=s.useCallback(async(t=1,i=10,f)=>{z(!0);try{const V=await Q.getClients({page:t,page_size:i,search:u||void 0,is_active:m,signal:f});o(V.items),n({current:V.page,pageSize:V.page_size,total:V.total})}catch(V){N(V)||g.error("获取客户列表失败")}finally{z(!1)}},[u,m,g]);s.useEffect(()=>{c.current&&c.current.abort();const t=new AbortController;return c.current=t,y(d.current,d.pageSize,t.signal),()=>{t.abort()}},[u,m]),s.useEffect(()=>{const t=setTimeout(()=>{x!==u&&$(x)},300);return()=>clearTimeout(t)},[x,u]);const I=t=>{c.current&&c.current.abort();const i=new AbortController;c.current=i,y(t.current,t.pageSize,i.signal)},M=()=>{b(null),v(!0)},k=t=>{b(t),v(!0)},A=()=>{v(!1),b(null),y(d.current,d.pageSize)},O=()=>{v(!1),b(null)},D=t=>{E(t?!0:void 0)},H=[{title:"客户名称",dataIndex:"name",key:"name",width:180},{title:"客户代码",dataIndex:"code",key:"code",width:120},{title:"优先级",dataIndex:"priority_level",key:"priority_level",width:90,render:t=>{const i=t,f=Se[i]||{text:`${i}`,color:"default"};return e.jsx(F,{color:f.color,children:f.text})}},{title:"SLA天数",dataIndex:"default_sla_days",key:"default_sla_days",width:90,render:t=>`${t} 天`},{title:"来源类别",dataIndex:"source_category",key:"source_category",width:100,render:t=>we[t]||t},{title:"联系人",dataIndex:"contact_name",key:"contact_name",width:100,render:t=>t||"-"},{title:"联系邮箱",dataIndex:"contact_email",key:"contact_email",width:180,render:t=>t||"-"},{title:"状态",dataIndex:"is_active",key:"is_active",width:80,render:t=>e.jsx(F,{color:t?"success":"default",children:t?"启用":"停用"})},{title:"操作",key:"action",width:100,render:(t,i)=>e.jsx(B,{type:"link",size:"small",icon:e.jsx(X,{}),onClick:()=>k(i),children:"编辑"})}];return e.jsxs("div",{"data-testid":"clients-page",children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsxs(Z,{wrap:!0,children:[e.jsx(S,{placeholder:"搜索客户名称或代码",prefix:e.jsx(ae,{}),value:x,onChange:t=>R(t.target.value),style:{width:220},allowClear:!0,"data-testid":"clients-search-input"}),e.jsxs(Z,{children:[e.jsx("span",{style:{fontSize:14,color:"#666"},children:"仅启用:"}),e.jsx(Y,{checked:m===!0,onChange:D,size:"small"})]})]}),e.jsx(B,{type:"primary",icon:e.jsx(W,{}),onClick:M,"data-testid":"clients-add-button",children:"新增客户"})]}),e.jsx(U,{columns:H,dataSource:_,rowKey:"id",loading:p,pagination:{...d,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条`},onChange:I,scroll:{x:1100},"data-testid":"clients-table"}),e.jsx(be,{visible:j,client:w,onSuccess:A,onCancel:O})]})}const{TextArea:Ie}=S,ke={[K.ANALYSIS]:"分析",[K.RELIABILITY]:"可靠性"};function ze(){const[_,o]=s.useState([]),[p,z]=s.useState([]),[j,v]=s.useState([]),[w,b]=s.useState([]),[d,n]=s.useState(!1),[x,R]=s.useState(!1),[u,$]=s.useState(null),[m,E]=s.useState({current:1,pageSize:20,total:0}),[g,c]=s.useState({}),[y]=r.useForm(),{message:I}=J.useApp(),M=s.useRef(!1),k=s.useRef(!0),A=s.useCallback(async(a=1,l=20)=>{n(!0);try{const C=await T.getClientSLAs({page:a,page_size:l,...g});k.current&&(o(C.items),E({current:C.page,pageSize:C.page_size,total:C.total}),M.current=!1)}catch(C){N(C)||k.current&&!M.current&&(M.current=!0,I.error("获取SLA配置列表失败"))}finally{k.current&&n(!1)}},[g,I]),O=s.useCallback(async()=>{try{const[a,l,C]=await Promise.all([Q.getAllClients(),me.getLaboratories({page_size:100}),T.getAllSourceCategories()]);k.current&&(z(a),v(l.items),b(C))}catch(a){N(a)||console.error("Failed to fetch reference data")}},[]);s.useEffect(()=>(k.current=!0,O(),()=>{k.current=!1}),[O]),s.useEffect(()=>{A()},[A]);const D=a=>{A(a.current,a.pageSize)},H=()=>{$(null),y.resetFields(),y.setFieldsValue({priority_weight:0,is_active:!0}),R(!0)},t=a=>{$(a),y.setFieldsValue({client_id:a.client_id,laboratory_id:a.laboratory_id,method_type:a.method_type,source_category_id:a.source_category_id,commitment_hours:a.commitment_hours,max_hours:a.max_hours,priority_weight:a.priority_weight,description:a.description,is_active:a.is_active}),R(!0)},i=async a=>{try{await T.deleteClientSLA(a),I.success("删除成功"),A(m.current,m.pageSize)}catch(l){N(l)||I.error("删除失败")}},f=async()=>{try{const a=await y.validateFields();u?(await T.updateClientSLA(u.id,a),I.success("更新成功")):(await T.createClientSLA(a),I.success("创建成功")),R(!1),A(m.current,m.pageSize)}catch(a){N(a)||I.error(u?"更新失败":"创建失败")}},V=a=>{const l=p.find(C=>C.id===a);return l?l.name:"-"},re=a=>{if(!a)return"所有实验室";const l=j.find(C=>C.id===a);return l?l.name:"-"},ie=a=>{c(l=>({...l,client_id:a}))},ne=a=>{c(l=>({...l,laboratory_id:a}))},oe=a=>{c(a===void 0||a===""?l=>({...l,is_active:void 0}):l=>({...l,is_active:a==="true"}))},ce=[{title:"客户",dataIndex:"client_id",key:"client_id",width:150,render:(a,l)=>l.client?.name||V(l.client_id)},{title:"实验室",dataIndex:"laboratory_id",key:"laboratory_id",width:150,render:(a,l)=>l.laboratory?.name||re(l.laboratory_id)},{title:"分析/测试方法",dataIndex:"method_type",key:"method_type",width:120,render:a=>a?e.jsx(F,{color:a===K.ANALYSIS?"blue":"green",children:ke[a]}):"-"},{title:"任务种类",dataIndex:"source_category_id",key:"source_category_id",width:120,render:(a,l)=>l.source_category?e.jsx(F,{color:l.source_category.color||"default",children:l.source_category.name}):"-"},{title:"承诺时间(小时)",dataIndex:"commitment_hours",key:"commitment_hours",width:130,render:a=>`${a}h`},{title:"最大时间(小时)",dataIndex:"max_hours",key:"max_hours",width:130,render:a=>a?`${a}h`:"-"},{title:"优先权重",dataIndex:"priority_weight",key:"priority_weight",width:100,render:a=>{const l=a;return e.jsx(F,{color:l>15?"red":l>5?"orange":"default",children:l})}},{title:"状态",dataIndex:"is_active",key:"is_active",width:80,render:a=>e.jsx(F,{color:a?"success":"default",children:a?"启用":"停用"})},{title:"操作",key:"action",width:150,render:(a,l)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(B,{type:"link",size:"small",icon:e.jsx(X,{}),onClick:()=>t(l),children:"编辑"}),e.jsx(se,{title:"确认删除",description:"确定要删除此SLA配置吗？",onConfirm:()=>i(l.id),okText:"确定",cancelText:"取消",okButtonProps:{danger:!0},children:e.jsx(B,{type:"link",size:"small",danger:!0,icon:e.jsx(le,{}),children:"删除"})})]})}];return e.jsxs("div",{"data-testid":"client-slas-page",children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[e.jsx(L,{placeholder:"客户",value:g.client_id,onChange:ie,style:{width:180},allowClear:!0,options:p.map(a=>({label:a.name,value:a.id})),"data-testid":"slas-client-filter"}),e.jsx(L,{placeholder:"实验室",value:g.laboratory_id,onChange:ne,style:{width:180},allowClear:!0,options:j.map(a=>({label:a.name,value:a.id})),"data-testid":"slas-lab-filter"}),e.jsx(L,{placeholder:"状态",value:g.is_active===void 0?void 0:g.is_active?"true":"false",onChange:oe,style:{width:100},allowClear:!0,options:[{label:"启用",value:"true"},{label:"停用",value:"false"}],"data-testid":"slas-status-filter"})]}),e.jsx(B,{type:"primary",icon:e.jsx(W,{}),onClick:H,"data-testid":"slas-add-button",children:"新增SLA配置"})]}),e.jsx(U,{columns:ce,dataSource:_,rowKey:"id",loading:d,pagination:{...m,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条`},onChange:D,scroll:{x:1100},"data-testid":"slas-table"}),e.jsx(G,{title:u?"编辑SLA配置":"新增SLA配置",open:x,onOk:f,onCancel:()=>R(!1),width:600,destroyOnHidden:!0,children:e.jsxs(r,{form:y,layout:"vertical",children:[e.jsx(r.Item,{name:"client_id",label:"客户",rules:[{required:!0,message:"请选择客户"}],children:e.jsx(L,{placeholder:"选择客户",options:p.map(a=>({label:`${a.name} (${a.code})`,value:a.id})),disabled:!!u})}),e.jsx(r.Item,{name:"laboratory_id",label:"实验室",extra:"留空则适用于所有实验室",children:e.jsx(L,{placeholder:"选择实验室（可选）",allowClear:!0,options:j.map(a=>({label:a.name,value:a.id}))})}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"method_type",label:"分析/测试方法",children:e.jsx(L,{placeholder:"选择方法类型",allowClear:!0,options:[{label:"分析",value:K.ANALYSIS},{label:"可靠性",value:K.RELIABILITY}]})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"source_category_id",label:"任务种类",children:e.jsx(L,{placeholder:"选择来源类别",allowClear:!0,options:w.map(a=>({label:a.name,value:a.id}))})})})]}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"commitment_hours",label:"承诺时间(小时)",rules:[{required:!0,message:"请输入承诺时间"}],children:e.jsx(q,{min:1,style:{width:"100%"},placeholder:"目标完成时间"})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"max_hours",label:"最大时间(小时)",children:e.jsx(q,{min:1,style:{width:"100%"},placeholder:"最长允许时间"})})})]}),e.jsx(r.Item,{name:"priority_weight",label:"优先权重",extra:"0-30，数值越高优先级越高",children:e.jsx(q,{min:0,max:30,style:{width:"100%"}})}),e.jsx(r.Item,{name:"description",label:"描述",children:e.jsx(Ie,{rows:2,placeholder:"SLA配置说明"})}),u&&e.jsx(r.Item,{name:"is_active",label:"状态",valuePropName:"checked",children:e.jsx(Y,{checkedChildren:"启用",unCheckedChildren:"停用"})})]})})]})}const{TextArea:Ae}=S;function Le(){const[_,o]=s.useState([]),[p,z]=s.useState(!1),[j,v]=s.useState(!1),[w,b]=s.useState(null),[d,n]=s.useState({current:1,pageSize:50,total:0}),[x,R]=s.useState(""),[u,$]=s.useState(""),[m]=r.useForm(),E=s.useRef(!1),g=s.useRef(!0),{message:c}=J.useApp(),y=s.useCallback(async(t=1,i=50)=>{z(!0);try{const f=await T.getSourceCategories({page:t,page_size:i,search:u||void 0});g.current&&(o(f.items),n({current:f.page,pageSize:f.page_size,total:f.total}),E.current=!1)}catch(f){N(f)||g.current&&!E.current&&(E.current=!0,c.error("获取来源类别列表失败"))}finally{g.current&&z(!1)}},[u,c]);s.useEffect(()=>(g.current=!0,()=>{g.current=!1}),[]),s.useEffect(()=>{y()},[y]),s.useEffect(()=>{const t=setTimeout(()=>{x!==u&&$(x)},300);return()=>clearTimeout(t)},[x,u]);const I=t=>{y(t.current||1,t.pageSize||50)},M=()=>{b(null),m.resetFields(),m.setFieldsValue({priority_weight:10,display_order:0,is_active:!0,is_default:!1,color:"#1890ff"}),v(!0)},k=t=>{b(t),m.setFieldsValue({name:t.name,code:t.code,priority_weight:t.priority_weight,display_order:t.display_order,description:t.description||"",color:t.color||"#1890ff",is_active:t.is_active,is_default:t.is_default}),v(!0)},A=async t=>{try{await T.deleteSourceCategory(t),c.success("删除成功"),y(d.current,d.pageSize)}catch(i){const f=i&&typeof i=="object"&&"response"in i?i.response?.data?.detail:"删除失败";c.error(f||"删除失败")}},O=async()=>{try{const t=await m.validateFields();w?(await T.updateSourceCategory(w.id,t),c.success("更新成功")):(await T.createSourceCategory(t),c.success("创建成功")),v(!1),y(d.current,d.pageSize)}catch(t){if(t&&typeof t=="object"&&"errorFields"in t)return;c.error(w?"更新失败":"创建失败")}},D=t=>t>=25?"error":t>=15?"warning":t>=10?"processing":"default",H=[{title:"名称",dataIndex:"name",key:"name",width:150,render:(t,i)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.color&&e.jsx("span",{style:{display:"inline-block",width:12,height:12,borderRadius:2,backgroundColor:i.color}}),e.jsx("span",{children:t}),i.is_default&&e.jsx(he,{style:{color:"#faad14"}})]})},{title:"代码",dataIndex:"code",key:"code",width:120},{title:"优先权重",dataIndex:"priority_weight",key:"priority_weight",width:100,render:t=>e.jsx(F,{color:D(t),children:t})},{title:"显示顺序",dataIndex:"display_order",key:"display_order",width:100},{title:"描述",dataIndex:"description",key:"description",render:t=>t||"-"},{title:"状态",dataIndex:"is_active",key:"is_active",width:80,render:t=>e.jsx(F,{color:t?"success":"default",children:t?"启用":"停用"})},{title:"默认",dataIndex:"is_default",key:"is_default",width:80,render:t=>t?e.jsx(F,{color:"warning",children:"默认"}):"-"},{title:"操作",key:"action",width:150,render:(t,i)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(B,{type:"link",size:"small",icon:e.jsx(X,{}),onClick:()=>k(i),children:"编辑"}),e.jsx(se,{title:"确认删除",description:i.is_default?"默认类别无法删除":"确定要删除此来源类别吗？",onConfirm:()=>A(i.id),okText:"确定",cancelText:"取消",children:e.jsx(B,{type:"link",size:"small",danger:!0,icon:e.jsx(le,{}),disabled:i.is_default,children:"删除"})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[e.jsx(S,{placeholder:"搜索名称或代码",prefix:e.jsx(ae,{style:{color:"#999"}}),value:x,onChange:t=>R(t.target.value),style:{width:224},allowClear:!0}),e.jsx(B,{type:"primary",icon:e.jsx(W,{}),onClick:M,children:"新增来源类别"})]}),e.jsx(U,{columns:H,dataSource:_,rowKey:"id",loading:p,pagination:{current:d.current,pageSize:d.pageSize,total:d.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条`},onChange:I,scroll:{x:900}}),e.jsx(G,{title:w?"编辑来源类别":"新增来源类别",open:j,onOk:O,onCancel:()=>v(!1),width:500,destroyOnHidden:!0,children:e.jsxs(r,{form:m,layout:"vertical",children:[e.jsx(r.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入名称"}],children:e.jsx(S,{placeholder:"类别名称"})}),e.jsx(r.Item,{name:"code",label:"代码",rules:[{required:!0,message:"请输入代码"}],children:e.jsx(S,{placeholder:"唯一代码，如: vip, internal",disabled:!!w})}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"priority_weight",label:"优先权重",extra:"0-30，数值越高优先级越高",children:e.jsx(q,{min:0,max:30,style:{width:"100%"}})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"display_order",label:"显示顺序",children:e.jsx(q,{min:0,style:{width:"100%"}})})})]}),e.jsx(r.Item,{name:"color",label:"颜色",children:e.jsx(S,{type:"color",style:{width:80,height:32,padding:0,border:"none"}})}),e.jsx(r.Item,{name:"description",label:"描述",children:e.jsx(Ae,{rows:2,placeholder:"类别说明"})}),e.jsxs(P,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"is_active",label:"状态",valuePropName:"checked",children:e.jsx(Y,{})})}),e.jsx(h,{span:12,children:e.jsx(r.Item,{name:"is_default",label:"设为默认",valuePropName:"checked",extra:"新工单默认使用此类别",children:e.jsx(Y,{})})})]})]})})]})}function He(){const[_,o]=s.useState("clients"),p=[{key:"clients",label:e.jsxs("span",{children:[e.jsx(ue,{}),"客户管理"]}),children:e.jsx(Ce,{})},{key:"sla",label:e.jsxs("span",{children:[e.jsx(ge,{}),"SLA配置"]}),children:e.jsx(ze,{})},{key:"source-categories",label:e.jsxs("span",{children:[e.jsx(je,{}),"来源类别"]}),children:e.jsx(Le,{})}];return e.jsx("div",{"data-testid":"client-group-page",children:e.jsx(de,{activeKey:_,onChange:o,items:p,size:"large",style:{marginTop:-16},"data-testid":"client-group-tabs"})})}export{He as default};
